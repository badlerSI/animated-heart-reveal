# SOUL Student App - Docker Compose
# For local testing and production deployment on Chromebooks
#
# Usage:
#   docker-compose up -d      # Start in background
#   docker-compose logs -f    # View logs
#   docker-compose down       # Stop and remove

services:
  soul-student-app:
    build:
      context: .
      dockerfile: Dockerfile
    image: soul-student-app:latest
    container_name: soul-student-app
    ports:
      - "3000:8080"

    # Allow container to reach host machine (for backend API proxy)
    extra_hosts:
      - "host.docker.internal:host-gateway"

    # Restart policy
    restart: unless-stopped

    # Health check
    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:8080/health"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 5s

    # Logging configuration
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
